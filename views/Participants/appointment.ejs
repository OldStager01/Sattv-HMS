<!-- Inside Accoridian start-->
<div
  x-data="{ accordionOpen: true }"
  @click.outside="accordionOpen = false"
  class="rounded-md border border-stroke mb-10 px-4 py-3 shadow-9 dark:border-strokedark dark:shadow-none md:px-6 xl:px-7.5"
>
  <button
    @click="accordionOpen = !accordionOpen"
    class="flex w-full items-center justify-between gap-2"
  >
    <div>
      <h4 class="text-left text-md font-bold text-black dark:text-white">
        Personal Information
      </h4>
    </div>

    <div
      class="flex h-9 w-full max-w-9 items-center justify-center rounded-full border border-primary dark:border-white"
    >
      <svg
        :class="accordionOpen && 'hidden'"
        class="fill-primary dark:fill-white"
        width="15"
        height="15"
        viewBox="0 0 15 15"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M13.2969 6.51563H8.48438V1.70312C8.48438 1.15625 8.04688 0.773438 7.5 0.773438C6.95313 0.773438 6.57031 1.21094 6.57031 1.75781V6.57031H1.75781C1.21094 6.57031 0.828125 7.00781 0.828125 7.55469C0.828125 8.10156 1.26563 8.48438 1.8125 8.48438H6.625V13.2969C6.625 13.8438 7.0625 14.2266 7.60938 14.2266C8.15625 14.2266 8.53906 13.7891 8.53906 13.2422V8.42969H13.3516C13.8984 8.42969 14.2813 7.99219 14.2813 7.44531C14.2266 6.95312 13.7891 6.51563 13.2969 6.51563Z"
          fill=""
        />
      </svg>

      <svg
        :class="accordionOpen === true ? 'block' : 'hidden'"
        class="fill-primary dark:fill-white"
        width="15"
        height="3"
        viewBox="0 0 15 3"
        fill="none"
        xmlns="http://www.w3.org/2000/svg"
      >
        <path
          d="M13.503 0.447144C13.446 0.447144 13.503 0.447144 13.503 0.447144H1.49482C0.925718 0.447144 0.527344 0.902427 0.527344 1.47153C0.527344 2.04064 0.982629 2.43901 1.55173 2.43901H13.5599C14.129 2.43901 14.5273 1.98373 14.5273 1.41462C14.4704 0.902427 14.0151 0.447144 13.503 0.447144Z"
          fill=""
        />
      </svg>
    </div>
  </button>

  <div
    x-show="accordionOpen"
    class="text-black dark:text-white p-2 mt-5 duration-200 ease-in-out"
  >
    <div class="mb-5">
      <div class="flex gap-5 flex-col mb-7 md:flex-row">
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            First Name
          </label>
          <input
            disabled
            required
            disabled
            type="text"
            value="<%= user.firstName %>"
            placeholder="First Name"
            name="firstName"
            class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
          />
        </div>
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            Last Name
          </label>
          <input
            disabled
            required
            disabled
            type="text"
            placeholder="Last Name"
            value="<%= user.lastName %>"
            name="lastName"
            class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
          />
        </div>
      </div>
      <div class="flex gap-5 flex-col mb-7 md:flex-row">
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            Phone No.
          </label>
          <input
            disabled
            required
            type="tel"
            value="<%= user.contact %>"
            placeholder="Phone No."
            name="contact"
            class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
          />
        </div>
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            Email
          </label>
          <input
            disabled
            required
            type="email"
            value="<%= user.email %>"
            placeholder="Email"
            name="email"
            class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
          />
        </div>
      </div>
      <div class="flex gap-5 flex-col mb-7 md:flex-row">
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            Age
          </label>
          <input
            disabled
            required
            type="number"
            name="age"
            id="age"
            placeholder="Age"
            class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
          />
        </div>
        <div class="flex-1">
          <label
            class="mb-3 block text-sm font-medium text-black dark:text-white"
          >
            Gender
          </label>
          <div
            x-data="{ isOptionSelected: false }"
            class="relative z-20 dark:bg-form-input"
          >
            <select
              disabled
              required
              name="gender"
              class="relative z-20 w-full appearance-none rounded border border-stroke bg-transparent py-3 pl-5 pr-12 outline-none transition focus:border-primary active:border-primary dark:border-form-strokedark dark:bg-form-input"
              :class="isOptionSelected && 'text-black dark:text-white'"
              @change="isOptionSelected = true"
            >
              <option value="male" class="text-body">Male</option>
              <option value="female" class="text-body">Female</option>
              <option value="other" class="text-body">Other</option>
            </select>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Inside Accoridian end -->

<form
  id="appointmentForm"
  action="/users/<%= id %>/appointment"
  method="post"
  enctype="multipart/form-data"
>
  <div class="flex gap-5 flex-col mb-7 md:flex-row">
    <div class="flex-1">
      <label class="mb-3 block text-sm font-medium text-black dark:text-white">
        Current Weight
      </label>
      <input
        type="text"
        placeholder="Current Weight"
        name="weight"
        class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
      />
    </div>
    <div class="flex-1">
      <label class="mb-3 block text-sm font-medium text-black dark:text-white">
        Waist Cicumference
      </label>
      <input
        type="text"
        placeholder="Waist Cicumference"
        name="waistCircumference"
        class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
      />
    </div>
  </div>
  <div class="flex gap-5 flex-col mb-7 md:flex-row">
    <div class="flex-[0.5]">
      <label class="mb-3 block text-sm font-medium text-black dark:text-white">
        Blood Pressure
      </label>
      <input
        type="text"
        placeholder="Blood Pressure"
        name="bloodPressure"
        class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
      />
    </div>
  </div>
  <div class="flex gap-5 flex-col mb-7 md:flex-row">
    <div class="flex-1">
      <label class="mb-3 block text-sm font-medium text-black dark:text-white">
        Participant Guidelines
      </label>
      <textarea
        rows="6"
        placeholder="Participant Guidelines"
        name="guidelines"
        class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
      ></textarea>
    </div>
  </div>
  <div class="flex gap-5 flex-col mb-7 md:flex-row">
    <div class="flex-1">
      <label class="mb-3 block text-sm font-medium text-black dark:text-white">
        Notes
      </label>
      <textarea
        rows="6"
        placeholder="Doctor Guidelines"
        name="notes"
        class="w-full rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
      ></textarea>
    </div>
  </div>
  <div class="mb-7">
    <label class="mb-3 block text-sm font-medium text-black dark:text-white">
      Attach file
    </label>
    <input
      type="file"
      name="files"
      multiple
      accept=".jpg, .jpeg, .png, .txt, .pdf, .doc, .docx, .xls, .xlsx, .ppt, .pptx"
      class="w-full md:w-1/2 cursor-pointer rounded-lg border-[1.5px] border-stroke bg-transparent font-normal outline-none transition file:mr-5 file:border-collapse file:cursor-pointer file:border-0 file:border-r file:border-solid file:border-stroke file:bg-whiter file:px-5 file:py-3 file:hover:bg-primary file:hover:bg-opacity-10 focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:file:border-form-strokedark dark:file:bg-white/30 dark:file:text-white dark:focus:border-primary"
    />
  </div>
  <div class="mb-7">
    <label class="mb-3 block text-sm font-medium text-black dark:text-white">
      Next Appointment
    </label>
    <input
      type="datetime-local"
      name="nextAppointmentDate"
      class="w-full md:w-1/2 rounded-lg border-[1.5px] border-stroke bg-transparent px-5 py-3 font-normal text-black outline-none transition focus:border-primary active:border-primary disabled:cursor-default disabled:bg-whiter dark:border-form-strokedark dark:bg-form-input dark:text-white dark:focus:border-primary"
    />
  </div>
  <div class="flex flex-col gap-7 md:flex-row md:gap-10">
    <button
      type="submit"
      class="inline-flex items-center justify-center rounded-full bg-green-500 px-5 py-4 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-10"
    >
      Register
    </button>
    <button
      type="reset"
      class="inline-flex items-center justify-center rounded-full bg-red-600 px-5 py-4 text-center font-medium text-white hover:bg-opacity-90 lg:px-8 xl:px-10"
    >
      Reset
    </button>
  </div>
</form>
<script>
  document.addEventListener("DOMContentLoaded", function () {
    const genderSelect = document.getElementsByName("gender")[0];
    genderSelect.value = "<%= user.gender %>";

    const todayDate = new Date(`<%= today %>`);
    const dob = new Date(`<%= user.dob %>`);
    const age = calculateAge(todayDate, dob);
    const ageElement = document.getElementById("age");
    ageElement.value = age;
    console.log(todayDate, dob, age);
    function calculateAge(today, dob) {
      let age = today.getFullYear() - dob.getFullYear();
      const month = today.getMonth() - dob.getMonth();
      if (month < 0 || (month === 0 && today.getDate() < dob.getDate())) {
        age--;
      }
      return age;
    }
  });
</script>
<script src="/js/participants/appointmentValidation.js"></script>
